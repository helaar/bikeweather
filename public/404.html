<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Redirecting...</title>
  <script>
    // Single Page Apps for GitHub Pages
    // MIT License
    // https://github.com/rafgraph/spa-github-pages
    // This script takes the current URL and converts the path and query
    // string into just a query string, and then redirects the browser
    // to the new URL with only a query string and hash fragment.

    // Parse the URL
    var pathSegmentsToKeep = 1; // Keep /bikeweather/ as the base path
    var l = window.location;
    
    // Extract the path from the URL
    var origin = l.protocol + '//' + l.hostname + (l.port ? ':' + l.port : '');
    var basePathname = l.pathname.split('/').slice(0, 1 + pathSegmentsToKeep).join('/');
    var pathname = l.pathname.slice(basePathname.length);
    var search = l.search;
    var hash = l.hash;
    
    // Reconstruct the URL with the path encoded in the query string
    var redirectUrl = origin + basePathname + '?p=' + encodeURIComponent(pathname + search + hash);
    
    // Log for debugging
    console.log('SPA Redirect - Original URL:', l.href);
    console.log('SPA Redirect - Base Path:', basePathname);
    console.log('SPA Redirect - Path to redirect:', pathname + search + hash);
    console.log('SPA Redirect - Redirecting to:', redirectUrl);
    
    // Redirect to the new URL
    window.location.href = redirectUrl;
  </script>
</head>
<body>
  <h1>Redirecting...</h1>
  <p>If you are not redirected automatically, click <a id="redirect-link" href="">here</a>.</p>
  <script>
    document.getElementById('redirect-link').href = window.location.href;
  </script>
</body>
</html>